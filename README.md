# GuToWire

ä¸€ä¸ªåŸºäº Google Wire çš„ Go ä¾èµ–æ³¨å…¥ä»£ç ç”Ÿæˆå·¥å…·ï¼Œé€šè¿‡æ³¨è§£è‡ªåŠ¨ç”Ÿæˆä¾èµ–æ³¨å…¥é…ç½®ã€‚

## ç‰¹æ€§

- ğŸš€ **æ³¨è§£é©±åŠ¨**ï¼šä½¿ç”¨ `@autowire` æ³¨è§£æ ‡è®°éœ€è¦æ³¨å…¥çš„ç»„ä»¶
- ğŸ”§ **è‡ªåŠ¨æ‰«æ**ï¼šé€’å½’æ‰«æé¡¹ç›®ç›®å½•ï¼Œè‡ªåŠ¨å‘ç°æ‰€æœ‰æ ‡è®°çš„ç»„ä»¶
- ğŸ“¦ **åˆ†ç»„ç®¡ç†**ï¼šæ”¯æŒå°†ç»„ä»¶åˆ†ç»„åˆ°ä¸åŒçš„ Set ä¸­
- ğŸ”Œ **æ¥å£ç»‘å®š**ï¼šè‡ªåŠ¨è¯†åˆ«æ¥å£å®ç°å…³ç³»
- âš™ï¸ **é…ç½®æ³¨å…¥**ï¼šæ”¯æŒé…ç½®ç»“æ„ä½“å­—æ®µçº§åˆ«çš„æ³¨å…¥
- ğŸ¯ **å¿«é€ŸåŸå‹**ï¼šæä¾› `IWantA` é­”æ³•å‡½æ•°ç”¨äºå¿«é€Ÿå¼€å‘
- âš¡ **é«˜æ€§èƒ½**ï¼šå¹¶å‘æ‰«æï¼Œæ™ºèƒ½ç¼“å­˜ï¼Œæ€§èƒ½æå‡ 50-80%
- ğŸ‘€ **Watch æ¨¡å¼**ï¼šè‡ªåŠ¨ç›‘å¬æ–‡ä»¶å˜åŒ–å¹¶é‡æ–°ç”Ÿæˆ
- ğŸ“ **é…ç½®æ–‡ä»¶**ï¼šæ”¯æŒ YAML é…ç½®æ–‡ä»¶ç®¡ç†é¡¹ç›®è®¾ç½®

## å¿«é€Ÿå¼€å§‹

### å®‰è£…

```bash
go install github.com/spelens-gud/gutowire@latest
```

### åŸºæœ¬ç”¨æ³•

1. åœ¨ä½ çš„ç»“æ„ä½“æˆ–æ„é€ å‡½æ•°ä¸Šæ·»åŠ  `@autowire` æ³¨è§£ï¼š

```go
// @autowire(set=animals)
type Dog struct {
    Name string
}

// @autowire(set=animals)
func NewCat() *Cat {
    return &Cat{}
}
```

2. è¿è¡Œ gutowire ç”Ÿæˆ Wire é…ç½®ï¼š

```bash
gutowire ./path/to/your/package
```

3. è¿è¡Œ wire ç”Ÿæˆæœ€ç»ˆä»£ç ï¼š

```bash
cd ./path/to/your/package && wire
```

### æ³¨è§£è¯­æ³•

#### åŸºç¡€ç”¨æ³•

```go
// @autowire(set=animals)
type Dog struct {}
```

#### æ¥å£ç»‘å®š

```go
// @autowire(set=animals,Animal)
type Dog struct {}
```

#### è‡ªå®šä¹‰æ„é€ å‡½æ•°

```go
// @autowire(set=animals,new=CustomConstructor)
type Dog struct {}

func CustomConstructor() *Dog {
    return &Dog{}
}
```

#### åˆå§‹åŒ–å…¥å£

```go
// @autowire.init(set=zoo)
type Zoo struct {
    Animals []Animal
}
```

#### é…ç½®æ³¨å…¥

```go
// @autowire.config(set=config)
type Config struct {
    Host string
    Port int
}
```

## å‘½ä»¤è¡Œé€‰é¡¹

```bash
gutowire [flags] <ç”Ÿæˆè·¯å¾„>

Flags:
  -w, --wire_path string   Wire é…ç½®æ–‡ä»¶ç”Ÿæˆè·¯å¾„
  -s, --scope string       ä¾èµ–æœç´¢èŒƒå›´(ç›®å½•è·¯å¾„)ï¼Œä¸å¡«åˆ™å…¨å±€æœç´¢
  -p, --pkg string         ç”Ÿæˆæ–‡ä»¶çš„åŒ…å
  --watch                  å¯ç”¨ Watch æ¨¡å¼ï¼Œè‡ªåŠ¨ç›‘å¬æ–‡ä»¶å˜åŒ–
  --config string          æŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„ï¼ˆé»˜è®¤ .gutowire.yamlï¼‰
  --init                   ç”Ÿæˆé»˜è®¤é…ç½®æ–‡ä»¶
  --no-cache              ç¦ç”¨æ–‡ä»¶ç¼“å­˜
```

## é«˜çº§åŠŸèƒ½

### Watch æ¨¡å¼

è‡ªåŠ¨ç›‘å¬æ–‡ä»¶å˜åŒ–å¹¶é‡æ–°ç”Ÿæˆä»£ç ï¼Œé€‚åˆå¼€å‘é˜¶æ®µä½¿ç”¨ï¼š

```bash
# å¯åŠ¨ watch æ¨¡å¼
gutowire --watch ./wire

# ä¿®æ”¹ä»£ç åä¼šè‡ªåŠ¨é‡æ–°ç”Ÿæˆ
```

### é…ç½®æ–‡ä»¶

ä½¿ç”¨ YAML é…ç½®æ–‡ä»¶ç®¡ç†é¡¹ç›®è®¾ç½®ï¼š

```bash
# ç”Ÿæˆé»˜è®¤é…ç½®æ–‡ä»¶
gutowire --init

# ä½¿ç”¨é…ç½®æ–‡ä»¶
gutowire --config=.gutowire.yaml
```

é…ç½®æ–‡ä»¶ç¤ºä¾‹ï¼ˆ`.gutowire.yaml`ï¼‰ï¼š

```yaml
# åŸºç¡€é…ç½®
search_path: ./
output_path: ./wire
package: wire

# åˆå§‹åŒ–é…ç½®
init_types:
  - App
  - Server

# æ€§èƒ½é…ç½®
enable_cache: true
parallel: 0 # 0 è¡¨ç¤ºè‡ªåŠ¨æ£€æµ‹ CPU æ ¸å¿ƒæ•°

# é«˜çº§é…ç½®
exclude_dirs:
  - vendor
  - testdata
  - .git

# Watch æ¨¡å¼é…ç½®
watch: false
watch_ignore:
  - "*.gen.go"
  - "wire_gen.go"
```

## ç¤ºä¾‹

æŸ¥çœ‹ `examples/` ç›®å½•è·å–å®Œæ•´ç¤ºä¾‹ã€‚

## æ€§èƒ½ä¼˜åŒ–

GuToWire v2.0 è¿›è¡Œäº†å…¨é¢çš„æ€§èƒ½ä¼˜åŒ–ï¼š

- **å¹¶å‘æ‰«æ**ï¼šçœŸæ­£çš„å¹¶å‘æ–‡ä»¶å¤„ç†ï¼Œæå‡ 3-5 å€
- **æ™ºèƒ½æ£€æŸ¥**ï¼šå¿«é€Ÿæ£€æŸ¥æ–‡ä»¶æ˜¯å¦åŒ…å«æ³¨è§£ï¼Œå‡å°‘ 50-90% I/O
- **è·¯å¾„ç¼“å­˜**ï¼šé¿å…é‡å¤è®¡ç®—åŒ…è·¯å¾„ï¼Œæå‡ 10-20%
- **æ€»ä½“æå‡**ï¼š50-80% æ€§èƒ½æå‡

### æ€§èƒ½å¯¹æ¯”

| é¡¹ç›®è§„æ¨¡             | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æå‡ |
| -------------------- | ------ | ------ | ---- |
| å°å‹ï¼ˆ<100 æ–‡ä»¶ï¼‰    | 3s     | 1s     | 3x   |
| ä¸­å‹ï¼ˆ100-500 æ–‡ä»¶ï¼‰ | 15s    | 5s     | 3x   |
| å¤§å‹ï¼ˆ>1000 æ–‡ä»¶ï¼‰   | 60s    | 15s    | 4x   |

## æ›´æ–°æ—¥å¿—

### v2.0 (2025-12-01)

**æ€§èƒ½ä¼˜åŒ–**ï¼š

- ä¿®å¤å¹¶å‘å®‰å…¨é—®é¢˜ï¼Œå®ç°çœŸæ­£çš„å¹¶å‘å¤„ç†
- æ·»åŠ æ–‡ä»¶å¿«é€Ÿæ£€æŸ¥ï¼Œé¿å…ä¸å¿…è¦çš„å®Œæ•´è¯»å–
- ä¼˜åŒ–åŒ…è·¯å¾„è®¡ç®—ï¼Œå‡å°‘é‡å¤è®¡ç®—
- æ”¹è¿›é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

**æ–°å¢åŠŸèƒ½**ï¼š

- Watch æ¨¡å¼ï¼šè‡ªåŠ¨ç›‘å¬æ–‡ä»¶å˜åŒ–
- é…ç½®æ–‡ä»¶æ”¯æŒï¼šYAML é…ç½®ç®¡ç†
- å‹å¥½çš„é”™è¯¯æç¤ºï¼šè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œè§£å†³å»ºè®®

**ä»£ç è´¨é‡**ï¼š

- æ·»åŠ  30+ å•å…ƒæµ‹è¯•
- golangci-lint æ£€æŸ¥é€šè¿‡ï¼ˆ0 issuesï¼‰
- æµ‹è¯•è¦†ç›–ç‡ï¼šconfig 95.5%, parser 53.5%

## å¼€å‘ç¯å¢ƒè®¾ç½®

### å¿…éœ€å·¥å…·

#### å®‰è£… Go

ä» Go å®˜ç½‘ä¸‹è½½äºŒè¿›åˆ¶åŒ…ï¼š`https://go.dev/doc/install`

```bash
rm -rf /usr/local/go && tar -C /usr/local -xzf go1.25.3.linux-amd64.tar.gz
```

#### å®‰è£… Google Wire

```bash
go install github.com/google/wire/cmd/wire@latest
```

## è®¸å¯è¯

æŸ¥çœ‹ LICENSE æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚
